@model  List<JN.Data.Shop_Product>
@{
    ViewBag.Title = "选择商品";
    Layout = "~/Areas/AdminCenter/Views/Shared/_Layout.cshtml";
}
<div id="content">
    <!-- Breadcrumb -->
    <ul class="breadcrumb">
        <li><a href="@Url.Action("Index", "Home")" class="glyphicons home"><i></i> 首页</a></li>
        <li class="divider"></li>
        <li>@ViewBag.Title</li>
    </ul>
    <div class="separator bottom"></div>
    <!-- // Breadcrumb END -->
    <div class="innerLR">
        <div class="tabbable">
            <div class="filter-bar margin-bottom-none">
                <form method="get" action="">
                    <div>
                        <label>商品名称:</label>
                        <div class="input-append">
                            <input type="text" name="ProName" value="@Request["ProName"]" />
                        </div>
                    </div>
                    @*<div>
                        <label>商铺名称:</label>
                        <div class="input-append">
                            <input type="text" name="ShopName" value="@Request["ShopName"]" />
                        </div>
                    </div>*@
                    <div>
                        <div> <input type="submit" value="查 询" /></div>
                    </div>
                </form>
            </div>
            <div style="height:700px;overflow-y:auto;">
                <div>
                    <table id="sample-table-1" class="table table-striped table-bordered table-hover">
                        <tr>
                            <th>&nbsp;&nbsp;&nbsp;&nbsp;图  片</th>
                            <th style="width: 80px; text-align: center">商品名称</th>
                            @*<th style="width: 80px; text-align: center">类别</th>*@
                            <th style="text-align:center">价  格</th>
                            <th style="text-align:center">创建时间</th>
                            <th style="text-align:center">库存量</th>
                            @*<th style="text-align:center">商铺名称</th>*@
                            <th style="text-align:center">选  择</th>
                        </tr>
                        @foreach (var item in Model)
                        {
                            <tr>
                                <td style="height: 90px; text-align: center">
                                    <img width="80px" src="@JN.Services.Tool.StringHelp.GetFirstStr(item.ImageUrl)">
                                </td>
                                <td style="text-align:center">
                                    <a href="#" target="_blank" class="blue">@item.ProductName</a>
                                </td>
                                @*<td style="text-align:center">
                                    @(SandMem.BLL.ProductCategory.GetName(item["GoodsClassId"].ToString()))
                                </td>*@

                                @*<td><input type="checkbox" gid="@item["ID"]" onclick="IsNew(this)" @(Convert.ToBoolean(item["IsNew"]) == true ? "checked" : "") /></td>*@

                                <td style="text-align:center">￥@item.RealPrice</td>
                                <td style="text-align:center">
                                    <p>@(string.Format("{0:d}", item.CreateTime))</p>
                                </td>
                                <td style="text-align:center">@item.Stock.ToString() </td>
                                @*<td style="text-align:center">@item.ShopName</td>*@
                                <td style="text-align:center">
                                   @* <input type="checkbox" name="check"  onclick="IsSel(@item.Id)" />*@
                                    <input type="checkbox" name="check" data-value="@item.Id" onclick="IsSel(this)" />
                                    <div style="display:none; color:red" class="@item.Id">已选择</div> 
                                </td>

                            </tr>
                        }
                    </table>
                </div>

            </div>

            <div>
                @using (Ajax.BeginForm("SelectProduct", new { }, new AjaxOptions() { HttpMethod = "Post", OnSuccess = "afterPost" }, new { id = "saveForm", @class = "form-horizontal" }))
    {
                <input type="hidden" id="hidChkProId" name="selId" />
                    <input type="hidden" id="hidChkProId" name="type" value="@Request["type"]" />
                <button class="btn btn-primary" type="submit" id="submit">
                    确  定
                </button>
                }
            </div>
        </div>

        </div>
    </div>
    @section scripts{
<script src="~/Plugin/Jquery/jquery.unobtrusive-ajax.min.js"></script>
        <script type="text/javascript">
            function IsSel(obj) {
                var id = $(obj).attr("data-value");
                if ($(obj).is(':checked')) {
                    $("#hidChkProId").val($("#hidChkProId").val() + id + ",");
                    $("." + id + "").css("display","block");//标识选择
                } else {
                    $("#hidChkProId").val($("#hidChkProId").val().replace(id + ",", ""));
                    $("." + id + "").css("display","none");//选择取消
                }
            }

            function afterPost(data) {
                if (data.Status == 200) {
                    alert("添加成功!");
                    window.location.reload();
                } else {
                    alert("保存失败！错误信息：" + data.Message);
                }
            } 
 
       </script>
    }
