@{
    Layout = "~/Areas/APP/Views/Shared/_Layout" + JN.Services.Tool.ConfigHelper.GetConfigString("Theme") + ".cshtml";
    //var cacheSysParam = MvcCore.Unity.Get<JN.Data.Service.ISysParamService>().ListCache("sysparams", x => x.ID < 6000);
    JN.Data.User Umodel = null;
    if (JN.Services.UserLoginHelper.CurrentUser() == null)
    {
        Response.Redirect(Url.Action("Index", "Login"));
    }
    else
    {
        Umodel = MvcCore.Unity.Get<JN.Data.Service.IUserService>().Single(JN.Services.UserLoginHelper.CurrentUser().ID);
    }
}
<link href="/Theme/APP/css/shop.css" rel="stylesheet">
<link href="/Theme/APP/css/user.css" rel="stylesheet">
<header class="header">
    <div class="header-return">
        <a href="javascript:history.go(-1);"></a>
    </div>

    <div class="logo">@T("我的订单")</div>
</header>

<section class="container order-container">
    <div class="tab_switch clearfix" id="sidebar">
        <ul>
            <li><a href="javascript:" id="status1" class="int_active" onclick="ategory(1,-1)">@T("全部")</a></li>
            @*<li><a href="javascript:" onclick="ategory(0)">@T("待付款")</a></li>*@
            <li><a href="javascript:" id="status2" onclick="ategory(2, 1)">@T("待发货")</a></li>
            <li><a href="javascript:" id="status3" onclick="ategory(3, 3)">@T("待收货")</a></li>
            <li><a href="javascript:" id="status4" onclick="ategory(4, 4)">@T("已完成")</a></li>
        </ul>
    </div>
    <input type="hidden" id="status" value="-1">
    <div id="myorderlist" style="position:relative; padding-bottom:1.8rem;">
    </div>

    @*<div class="load-more">
        <a href="">点击加载更多</a>
    </div>*@

    <!--<div class="load-no-more">
        <span>没有更多了</span>
    </div>-->
</section>
<script>
    function ategory(j, status) {
        $('#sidebar ul li a').removeClass('int_active');
        $("#status" + j).addClass('int_active');
        $("#status").val(status);
        $("#myorderlist").html("");
        Loadsearch()
    }

    $(function () {
        Loadsearch();
    });

    function Loadsearch() {
        var status = $("#status").val();
        layui.use('flow', function () {
            //var $ = layui.jquery; //不用额外加载jQuery，flow模块本身是有依赖jQuery的，直接用即可。
            var flow = layui.flow;
            flow.load({
                elem: '#myorderlist', //指定列表容器
                isAuto: false,//是否自动加载
                done: function (page, next) { //到达临界点（默认滚动触发），触发下一页
                    var lis = [];
                    //以jQuery的Ajax请求为例，请求下一页数据（注意：page是从2开始返回）
                    $.get('@Url.Action("getShop_Order", "shop")?page=' + page + '&status=' + status, function (res) {
                        var strhtml = "";
                        //假设你的列表返回在data集合中
                        layui.each(res.data, function (index, item) {
                            strhtml = "";
                            strhtml += '<div class="order">';
                            strhtml += '<div class="order-title">';
                            strhtml += '<a href="/APP/shop/ProductInfo?id=' + item.GoodsId + '" class="order-shop fl">' + item.ShopName + '</a>';
                            strhtml += '<span class="order-status fr">' + item.Remark + '</span>';
                            strhtml += '</div>';
                            strhtml += '<a href="/APP/shop/MyOrderDetail?id=' + item.DetailsId + '" class="order-info">';
                            strhtml += '<div class="order-item">';
                            strhtml += '<img src="' + item.Img + '" />';
                            strhtml += ' <h1>' + item.GoodsName + '</h1>';
                            strhtml += '<div class="order-price">';
                            strhtml += '<h3>¥ ' + item.OneFee + '</h3>';
                            strhtml += '<span>×' + item.ByCount + '</span>';
                            strhtml += '</div>';
                            strhtml += '</div>';
                            strhtml += '</a>';
                            strhtml += '<div class="order-summary">';
                            strhtml += '<span>@T("实付"):</span>';
                            strhtml += '<b>¥' + item.TotalFee + '</b>';
                            strhtml += '<span>(@T("免运费"))</span>';
                            strhtml += '</div>';
                            strhtml += '<div class="order-toolbar">';
                            //if (item.Status == 1) {//待发货
                            //    strhtml += '<a href="">取消订单</a>';
                            //    //strhtml += '<a href="" class="active">去付款</a>';
                            //}
                            if (item.Status == 1) {//已经发货
                                strhtml += '<a href="###" class="active" onclick="DeliverGoods(&apos;' + item.OrderNumber + '&apos;)">@T("确认发货")</a>';
                                //strhtml += '<a href="AfterSales.html" class="active">申请售后</a>';
                            }
                            //strhtml += '<a href="">删除订单</a>';
                            //strhtml += '<a href="Comment.html" class="active">去评价</a>';
                            strhtml += '</div>';
                            strhtml += '</div>';
                            lis.push(strhtml);
                        });
                        //alert(lis);
                        //执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                        //pages为Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                        next(lis.join(''), page < res.pages);
                    });
                }
            });
        });
    }

    //日期格式转换
    function ChangeDateFormat(jsondate) {
        jsondate = jsondate.replace("/Date(", "").replace(")/", "");
        if (jsondate.indexOf("+") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("+"));
        }
        else if (jsondate.indexOf("-") > 0) {
            jsondate = jsondate.substring(0, jsondate.indexOf("-"));
        }

        var date = new Date(parseInt(jsondate, 10));
        var month = date.getMonth() + 1 < 10 ? "0" + (date.getMonth() + 1) : date.getMonth() + 1;
        var currentDate = date.getDate() < 10 ? "0" + date.getDate() : date.getDate();
        var currentHours = date.getHours() < 10 ? "0" + date.getHours() : date.getHours();
        var currentMinutes = date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes();
        return month
            + "-"
            + currentDate
            + ""
            + " "
            + currentHours
            + ":"
            + currentMinutes;
    }
</script>
<script>
    //确认收货
    function DeliverGoods(OrderNumber) {
        layer.prompt({ title: '@T("请输入物流信息（格式为物流公司 + 物流单号）")', formType: 3}, function (val, index) {
            $.post('@Url.Action("DeliverGoods", "shop")', { OrderNumber: OrderNumber, Remark: val }, function (data) {
                if (data.Status == 200) {
                    layer.msg("@T("发货成功")！");
                    setTimeout(function () {  //使用  setTimeout（）方法设定定时2000毫秒
                        window.location.reload();//页面刷新
                    }, 2000);
                } else {
                    layer.msg("@T("操作失败")：" + data.Message);
                }
            });
        });
    };
</script>