@model JN.Data.Currency
@{
    ViewBag.Title = "转入";
    JN.Data.User Umodel = null;
    if (JN.Services.UserLoginHelper.CurrentUser() == null)
    {
        Response.Redirect(Url.Action("Index", "Login"));
    }
    else
    {
        Umodel = MvcCore.Unity.Get<JN.Data.Service.IUserService>().Single(JN.Services.UserLoginHelper.CurrentUser().ID);
    }
    Layout = "~/Areas/App/Views/Shared/_Layout" + JN.Services.Tool.ConfigHelper.GetConfigString("Theme") + ".cshtml";

        string Racoin = JN.Services.Manager.Users.GetWalletAddress((int)Model.WalletCurID, Umodel);
}
 <link href="/Theme/App/css/base.css" rel="stylesheet">


<header class="header">
    <div class="header-return mui-action-back">
        @*<a href="javascript:history.go(-1);"></a>*@
    </div>

    <div class="logo">@T("转入")</div>
</header>

<section class="container">
    <div class="setting-form">
        <div class="form-widget">
            <form action="" method="get">
                <div class="form-box">

                    <div class="form-group">
                        <label class="form-label">@T("转入地址")</label>

                        <div class="form-control">
                            <input value="@Racoin" id="qrcode_address" placeholder="@T("离线地址")" readonly class="primary-input">
                            <button class="" data-clipboard-action="copy" data-clipboard-text="@Racoin" id="d_clip_button">@T("复制")</button>
                        </div>
                    </div>
                    @if (string.IsNullOrEmpty(Racoin))
                    {
                        <div class="form-submit">
                            <button type="button" id="showaddress" class="form-submit-btn">@T("生成地址")</button>
                        </div>
                    }
                    else
                    {
                        <div class="form-submit">
                            <button type="button" id="createBtn" class="form-submit-btn">@T("同步转入数据")</button>
                        </div>
                    }
                </div>
            </form>
        </div>
    </div>
</section>

<script>
    $("#createBtn").click(function () {
        var btn = $(this);
        btn.html("加载中....");
        $.post("@(Url.Action("GetListTransactions"))", {curid:@Model.ID}, function (data) {
            location = '@(Url.Action("PayIn"))?curid=@Model.ID';
            btn.html("@T("同步数据")");
        });
    });

    $("#showaddress").click(function () {
        $("#showaddress").attr("disabled", "disabled");
        $.post("@(Url.Action("AjaxCreateNewAddress"))", { curid: @Model.ID}, function (data) {
            if (data.Status == 200) {
                location.reload();
            } else {
                $('#showaddress').removeAttr("disabled");
                alert(data.Message);
            }
        });
    });
</script>


<script src="~/Plugin/clipboard/js/clipboard.min.js"></script>
<script>
    $(document).ready(function () {
        var clipboard = new Clipboard('#d_clip_button');
    });
    $("#d_clip_button").click(function () {
        alert("@T("复制成功")")
    });
</script>

